<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script src="js/goodbye.js"></script>
    <script src="lib/graph-scroll.js"></script>
    <link href="css/scroll.css" rel="stylesheet" type="text/css"/>
    <link href="css/goodbye.css" rel="stylesheet" type="text/css"/>
</head>

<body>
<div class="slide">
    <h1>Goodbye RATP</h1>
    <p>Scroll down ⇓</p>
</div>
<div id='container'>
    <div id="graph"></div>
    <div id='sections'>
        <div class="trigger">
            <h3>2011 : Arrivée à la Régie</h3>
        </div>
        <div class="trigger">
            <h3>2012</h3>
        </div>
        <div class="trigger">
            <h3>2013</h3>
        </div>
        <div class="trigger">
            <h3>2014</h3>
        </div>
        <div class="trigger">
            <h3>2015</h3>
        </div>
        <div class="trigger">
            <h3>2016</h3>
        </div>
        <div class="trigger">
            <h3>2017</h3>
        </div>
        <div class="trigger">
            <h3>2018</h3>
        </div>
        <div class="trigger">
            <h3>Merci</h3>
        </div>
    </div>
</div>
<script>
    function graphscroll(refYear) {
        const graphicEl = d3.select('#container');
        const graphicVisEl = graphicEl.select('#graph');
        const triggerEls = graphicEl.selectAll('.trigger');

        // viewport height
        const viewportHeight = window.innerHeight;
        const halfViewportHeight = viewportHeight / 2;

        const main = new Goodbye();
        main.init(refYear);

        d3.graphScroll()
            .container(graphicEl)
            .graph(graphicVisEl)
            .sections(triggerEls)
            .offset(-100)
            .on('active', i => {
                if (i < 8) {
                    main.updateGraph(refYear + i);
                } else {
                    main.drawLogo();
                }
            })
    }

    graphscroll(2011);
</script>
</body>

</html>
